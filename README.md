````md
# –ü—Ä–æ–µ–∫—Ç: Telegram-–±–æ—Ç —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è
**–ê–≤—Ç–æ—Ä:** –ú–∏—Ö–∞–∏–ª –ö–∞–±—à–∞–Ω–æ–≤  
**GitHub:** kabshanov  
**Telegram:** @kabmik

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#—Å—Ç–µ–∫-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
- [–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–∏-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–û–ø–∏—Å–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π-–∏-–∫–ª—é—á–µ–≤—ã—Ö-—Ñ–∞–π–ª–æ–≤)
- [–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞](#–∫–æ–º–∞–Ω–¥—ã-–±–æ—Ç–∞)
- [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
- [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞](#–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö-–∏-–ø—Ä–∞–≤–∞-–¥–æ—Å—Ç—É–ø–∞)
- [–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è](#—Ç–∏–ø–∏—á–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è)
- [–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è](#–ø–ª–∞–Ω-—Ä–∞–∑–≤–∏—Ç–∏—è)

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì≤ **–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç**: —Å–æ–∑–¥–∞–Ω–∏–µ/–ø—Ä–æ—Å–º–æ—Ç—Ä/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –∏ –¥–∏–∞–ª–æ–≥–∏ FSM.
- üë• **–õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (TgUser)**:
  - –ü—Ä–∏–≤—è–∑–∫–∞ Telegram-–∞–∫–∫–∞—É–Ω—Ç–∞ –∫ —Å–∏—Å—Ç–µ–º–µ (`/login`);
  - –õ–∏—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–∑ ORM (`/calendar`);
  - –í –∞–¥–º–∏–Ω–∫–µ Django ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –µ–≥–æ —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ —Å—á—ë—Ç—á–∏–∫–∞–º–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
- ü§ù **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å—Ç—Ä–µ—á (Appointment)**:
  - –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–∞ —Å–≤–æ—ë —Å–æ–±—ã—Ç–∏–µ (–¥–∏–∞–ª–æ–≥ `/invite`);
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞; —Å—Ç–∞—Ç—É—Å—ã `pending/confirmed/declined/cancelled`;
  - –ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—É –∏ —É—á–∞—Å—Ç–Ω–∏–∫—É (–∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ ¬´‚úÖ/‚ùå¬ª).
- üóÑÔ∏è **–ï–¥–∏–Ω–∞—è –ë–î PostgreSQL** –¥–ª—è –±–æ—Ç–∞ –∏ Django:
  - –¢–∞–±–ª–∏—Ü–∞ `events` ‚Äî –æ–±—â–∞—è; Django-–º–æ–¥–µ–ª—å `Event` —á–∏—Ç–∞–µ—Ç –µ—ë (managed=False);
  - –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–æ–¥–µ–ª–∏ Django: `BotStatistics`, `Appointment`, `TgUser`.
- üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**:
  - –°—É—Ç–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –±–æ—Ç–∞ (`BotStatistics`): —Å–æ–∑–¥–∞–Ω–æ/–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ/–æ—Ç–º–µ–Ω–µ–Ω–æ, –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏;
  - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ –≤ `TgUser`: —Å–∫–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–ª/–∏—Å–ø—Ä–∞–≤–∏–ª/–æ—Ç–º–µ–Ω–∏–ª.
- üß© **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
  - –ü–∞–∫–µ—Ç `tgapp/` (—è–¥—Ä–æ, FSM, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π);
  - –ß–∏—Å—Ç—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å—Ç–∏–ª–µ PEP 8.
- üîê **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–ø—Ä–∞–≤–ª—è–µ—Ç **—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏–º–∏** —Å–æ–±—ã—Ç–∏—è–º–∏ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–∞ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏).

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3.11‚Äì3.13
- Django 5.x (–∞–¥–º–∏–Ω–∫–∞, ORM, –º–∏–≥—Ä–∞—Ü–∏–∏)
- python-telegram-bot 13.x (Updater/Dispatcher API)
- PostgreSQL 14‚Äì16
- psycopg2 / psycopg2-binary
- Django REST Framework (–∑–∞–ª–æ–∂–µ–Ω–æ –¥–ª—è –±—É–¥—É—â–∏—Ö API)
- logging (–±–∞–∑–æ–≤–∞—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è)

---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**Core:**
- Python ‚Äî https://docs.python.org/3/
- Django ‚Äî https://docs.djangoproject.com/
- python-telegram-bot v13 ‚Äî https://docs.python-telegram-bot.org/en/v13.15/
- PostgreSQL ‚Äî https://www.postgresql.org/docs/
- psycopg2 ‚Äî https://www.psycopg.org/docs/

**–ë–∞–∑–æ–≤—ã–µ –≤–µ–±-–ø–æ–Ω—è—Ç–∏—è (MDN):**
- HTTP ‚Äî https://developer.mozilla.org/en-US/docs/Web/HTTP
- URL ‚Äî https://developer.mozilla.org/en-US/docs/Web/API/URL
- JSON ‚Äî https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞**
- Python **3.11+**
- PostgreSQL **14+**
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (Telegram Bot API)
- –ü–æ—Ä—Ç **8000** —Å–≤–æ–±–æ–¥–µ–Ω (Django dev server)

**–ë—Ä–∞—É–∑–µ—Ä—ã (–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)**
- Chrome/Edge/Firefox ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏
- Safari ‚Äî 16+

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
git clone git@github.com:kabshanov/Python_TelegramBot_Kabshanov.git
cd Python_TelegramBot_Kabshanov
python -m venv .venv
# Windows PowerShell
. .venv/Scripts/Activate.ps1
# macOS/Linux
# source .venv/bin/activate
````

### 2) –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements_part2.txt
# –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
# pip install "django==5.*" "python-telegram-bot==13.13" "psycopg2-binary==2.*" "djangorestframework==3.*"
```

### 3) –°–µ–∫—Ä–µ—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î

1. –°–æ–∑–¥–∞–π—Ç–µ `bot_secrets.py` (–≤ `.gitignore`) –ø–æ –æ–±—Ä–∞–∑—Ü—É:

   * [`secrets_example.py`](./secrets_example.py) ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –∑–∞–¥–∞–π—Ç–µ `API_TOKEN`.

2. –ü–æ–¥–Ω–∏–º–∏—Ç–µ PostgreSQL –∏ –ø—Ä–∞–≤–∞:

```sql
CREATE DATABASE calendar_db;
CREATE USER calendar_user WITH PASSWORD 'strong_password';
GRANT ALL PRIVILEGES ON DATABASE calendar_db TO calendar_user;
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –æ–±–æ–∏—Ö –º–µ—Å—Ç–∞—Ö –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –ë–î:

   * Django: [`webapp/webapp/settings.py`](./webapp/webapp/settings.py) ‚Üí `DATABASES`
   * –ë–æ—Ç: [`db.py`](./db.py) ‚Üí `get_connection()`

### 4) –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

```bash
python webapp/manage.py migrate
python webapp/manage.py createsuperuser
```

### 5) –ó–∞–ø—É—Å–∫ (–¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞)

**A ‚Äî Django:**

```bash
python webapp/manage.py runserver
# http://127.0.0.1:8000/  –∏  http://127.0.0.1:8000/admin/
```

**B ‚Äî –ë–æ—Ç:**

```bash
python bot.py
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
Python_TelegramBot_Kabshanov/
‚îú‚îÄ bot.py                      # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –∏ FSM-—Ä–æ—É—Ç–µ—Ä–∞
‚îú‚îÄ db.py                       # psycopg2-CRUD –¥–ª—è users/events (–æ–±—â–∞—è –ë–î —Å Django)
‚îú‚îÄ secrets_example.py          # —à–∞–±–ª–æ–Ω —Å–µ–∫—Ä–µ—Ç–æ–≤
‚îú‚îÄ bot_secrets.py              # —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω (–≤ .gitignore)
‚îú‚îÄ requirements_part2.txt      # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ tgapp/                      # –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ (–º–æ–¥—É–ª—å–Ω–æ)
‚îÇ  ‚îú‚îÄ __init__.py              # –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞
‚îÇ  ‚îú‚îÄ core.py                  # –ª–æ–≥–≥–µ—Ä, –º–µ–Ω—é –∫–æ–º–∞–Ω–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Ç—Ä–µ–∫–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –∏ —Å—á—ë—Ç—á–∏–∫–æ–≤
‚îÇ  ‚îú‚îÄ fsm.py                   # –ø—Ä–æ—Å—Ç–∞—è in-memory FSM (flow/step/data) + –ø–∞—Ä—Å–µ—Ä—ã –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
‚îÇ  ‚îú‚îÄ handlers_events.py       # CRUD —Å–æ–±—ã—Ç–∏–π, /login, /calendar, —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–æ—É—Ç–µ—Ä (–≤–∫–ª—é—á–∞—è INVITE)
‚îÇ  ‚îî‚îÄ handlers_appointments.py # FSM –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π –∏ callback-–ª–æ–≥–∏–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π
‚îú‚îÄ webapp/
‚îÇ  ‚îú‚îÄ manage.py                # CLI Django
‚îÇ  ‚îú‚îÄ webapp/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ settings.py           # INSTALLED_APPS, –ë–î, –ª–æ–∫–∞–ª—å/—Ç–∞–π–º–∑–æ–Ω–∞, —Å—Ç–∞—Ç–∏–∫–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ urls.py               # –∫–æ—Ä–Ω–µ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (/admin, /)
‚îÇ  ‚îÇ  ‚îî‚îÄ wsgi.py
‚îÇ  ‚îî‚îÄ calendarapp/
‚îÇ     ‚îú‚îÄ __init__.py
‚îÇ     ‚îú‚îÄ apps.py               # AppConfig (verbose_name, name="calendarapp")
‚îÇ     ‚îú‚îÄ admin.py              # –∞–¥–º–∏–Ω–∫–∞: Event, TgUser, Appointment, BotStatistics
‚îÇ     ‚îú‚îÄ models.py             # Event(managed=False), TgUser, Appointment, BotStatistics
‚îÇ     ‚îú‚îÄ utils.py              # –∑–∞–Ω—è—Ç–æ—Å—Ç—å/—Å–ª–æ—Ç—ã –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å—Ç—Ä–µ—á
‚îÇ     ‚îú‚îÄ urls.py               # healthcheck
‚îÇ     ‚îú‚îÄ views.py              # healthcheck / —Ç–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (API)
‚îÇ     ‚îî‚îÄ migrations/           # –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–∫—Ä–æ–º–µ —Ç–∞–±–ª–∏—Ü—ã events)
‚îî‚îÄ .gitignore                  # –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è .venv, *.sqlite3, bot_secrets.py, *.md —Ä–∞–±–æ—á–∏–µ)
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

* [`bot.py`](./bot.py) ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Django-–æ–∫—Ä—É–∂–µ–Ω–∏—è, –∑–∞–ø—É—Å–∫ `Updater/Dispatcher`, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –∏ —Ä–æ—É—Ç–µ—Ä–∞.
* [`db.py`](./db.py) ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –∏ CRUD `users/events` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ—Ç–æ–º –Ω–∞–ø—Ä—è–º—É—é).
* [`tgapp/core.py`](./tgapp/core.py) ‚Äî –æ–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã: –ª–æ–≥–≥–µ—Ä, –º–µ–Ω—é –∫–æ–º–∞–Ω–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç—Ä–µ–∫–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫/—Å—á—ë—Ç—á–∏–∫–æ–≤, –¥–æ—Å—Ç—É–ø –∫ `CALENDAR`.
* [`tgapp/fsm.py`](./tgapp/fsm.py) ‚Äî in-memory FSM: `set_state/get_state/clear_state`, `parse_date/parse_time`.
* [`tgapp/handlers_events.py`](./tgapp/handlers_events.py) ‚Äî –∫–æ–º–∞–Ω–¥—ã: `/start /help /register /login /calendar /create_event /display_events /read_event /edit_event /delete_event /cancel` + —Ä–æ—É—Ç–µ—Ä —Ç–µ–∫—Å—Ç–æ–≤ (–≤–µ—Ç–∫–∞ `INVITE`).
* [`tgapp/handlers_appointments.py`](./tgapp/handlers_appointments.py) ‚Äî –¥–∏–∞–ª–æ–≥ `/invite` –∏ callback-–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤—Å—Ç—Ä–µ—á.
* [`webapp/calendarapp/models.py`](./webapp/calendarapp/models.py) ‚Äî `Event` (—á–∏—Ç–∞–µ—Ç –æ–±—â—É—é —Ç–∞–±–ª–∏—Ü—É `events`), `TgUser`, `Appointment`, `BotStatistics`.
* [`webapp/calendarapp/admin.py`](./webapp/calendarapp/admin.py) ‚Äî —É–¥–æ–±–Ω—ã–µ –∞–¥–º–∏–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã: –∏–Ω–ª–∞–π–Ω-—Å–æ–±—ã—Ç–∏—è —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å—á—ë—Ç—á–∏–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã, –ø–æ–∏—Å–∫.
* [`webapp/calendarapp/utils.py`](./webapp/calendarapp/utils.py) ‚Äî —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π.
* [`webapp/webapp/settings.py`](./webapp/webapp/settings.py) ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Django –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î.

---

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

* `/start`, `/help` ‚Äî –∫—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞.
* `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –±–∞–∑–µ (—Ç–∞–±–ª–∏—Ü–∞ `users`) –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ `TgUser`.
* `/login` ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ Telegram-–∞–∫–∫–∞—É–Ω—Ç–∞ –∫ `TgUser` (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è).
* `/calendar` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –ª–∏—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å (–¥–∞–Ω–Ω—ã–µ –∏–∑ ORM –ø–æ `tg_user_id`).
* `/create_event` ‚Äî –¥–∏–∞–ª–æ–≥: **–Ω–∞–∑–≤–∞–Ω–∏–µ ‚Üí –¥–∞—Ç–∞ YYYY-MM-DD ‚Üí –≤—Ä–µ–º—è HH:MM ‚Üí –æ–ø–∏—Å–∞–Ω–∏–µ**.
* `/display_events` ‚Äî —Å–ø–∏—Å–æ–∫ –º–æ–∏—Ö —Å–æ–±—ã—Ç–∏–π (—á–µ—Ä–µ–∑ `db.py`).
* `/read_event <id>` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –º–æ—ë —Å–æ–±—ã—Ç–∏–µ –ø–æ ID.
* `/edit_event [<id> <–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç>]` ‚Äî inline –∏–ª–∏ –¥–∏–∞–ª–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è.
* `/delete_event [<id>]` ‚Äî inline –∏–ª–∏ –¥–∏–∞–ª–æ–≥ —É–¥–∞–ª–µ–Ω–∏—è.
* `/invite` ‚Äî –¥–∏–∞–ª–æ–≥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –Ω–∞ –≤—Å—Ç—Ä–µ—á—É:

  1. TG ID —É—á–∞—Å—Ç–Ω–∏–∫–∞ ‚Üí 2) ID –≤–∞—à–µ–≥–æ —Å–æ–±—ã—Ç–∏—è ‚Üí 3) –¥–µ—Ç–∞–ª–∏/¬´–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å¬ª.
     –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞–Ω—è—Ç–æ—Å—Ç—å –∏, –µ—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω, —Å–æ–∑–¥–∞—Å—Ç `pending` –≤—Å—Ç—Ä–µ—á—É –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫—É –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏.
* `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞ (FSM).

> –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ **—Å—Ç—Ä–æ–≥–æ –ø–æ –≤–ª–∞–¥–µ–ª—å—Ü—É**: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ï–¥–∏–Ω–∞—è –ë–î**
   –ë–æ—Ç –ø–∏—à–µ—Ç/—á–∏—Ç–∞–µ—Ç `events` —á–µ—Ä–µ–∑ `db.py` (psycopg2). Django —á–∏—Ç–∞–µ—Ç —Ç–µ –∂–µ —Å—Ç—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å `Event (managed=False, db_table="events")`.

2. **–õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã (TgUser)**
   `/login` —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç `TgUser`.
   –í –∞–¥–º–∏–Ω–∫–µ –≤–∏–¥–Ω—ã: TG ID/username/–∏–º—è/—Ñ–∞–º–∏–ª–∏—è, —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å—á—ë—Ç—á–∏–∫–∏ –∏ **–∏–Ω–ª–∞–π–Ω-—Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

3. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**
   –ù–∞ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Å–æ–±—ã—Ç–∏–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ `tg_user_id` —Å–æ–±—ã—Ç–∏—è —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–æ–º –∑–∞–ø—Ä–æ—Å–∞.

4. **–í—Å—Ç—Ä–µ—á–∏ (Appointment)**
   `/invite` –∑–∞–ø—É—Å–∫–∞–µ—Ç FSM: –±–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –∑–∞–Ω—è—Ç –ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫ –≤ –¥–∞—Ç—É/–≤—Ä–µ–º—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (—á–µ—Ä–µ–∑ ORM –∏ `utils.is_user_free`).
   –ï—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è `Appointment (pending)`, —É—á–∞—Å—Ç–Ω–∏–∫—É –ª–µ—Ç–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å ¬´‚úÖ/‚ùå¬ª.
   –ù–∞–∂–∞—Ç–∏–µ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `confirmed/declined/cancelled` –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞.

5. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**

   * –ì–ª–æ–±–∞–ª—å–Ω–∞—è (`BotStatistics`) ‚Äî –∞–ø–¥–µ–π—Ç—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏.
   * –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è (`TgUser`) ‚Äî —Å—á—ë—Ç—á–∏–∫–∏ `created_total/edited_total/cancelled_total`.

6. **FSM**
   –õ—ë–≥–∫–æ–µ in-memory —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `flow/step/data` —Å —É—Ç–∏–ª–∏—Ç–∞–º–∏ `set_state/get_state/clear_state`.
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –¥–∏–∞–ª–æ–≥–∏ `CREATE`, `EDIT`, `DELETE`, `INVITE`. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è ¬´–û—Ç–º–µ–Ω–∞¬ª.

---

## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

* **Event** (`managed=False`, `db_table="events"`):

  * `id`, `name`, `date`, `time`, `details`, `tg_user_id (db_column="user_id")`.
  * –í–ª–∞–¥–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–µ–º ‚Äî –ø–æ `tg_user_id`. –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å/–º–µ–Ω—è—Ç—å/—É–¥–∞–ª—è—Ç—å.

* **TgUser**:

  * `tg_id`, `username`, `first_name`, `last_name`, `is_active`;
  * –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏: `created_total`, `edited_total`, `cancelled_total`;
  * related-inline —Å–æ —Å–ø–∏—Å–∫–æ–º —Å–æ–±—ã—Ç–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ.

* **Appointment**:

  * `event` (FK –±–µ–∑ DB-constraint –∫ `Event`), `organizer_tg_id`, `participant_tg_id`,
  * `date`, `time`, `details`,
  * `status`: `pending | confirmed | declined | cancelled`.

* **BotStatistics**:

  * `date (unique)`, `user_count`, `event_count`, `edited_events`, `cancelled_events`.

---

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

* **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞: `No module named 'webapp.settings'`**
  –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `python bot.py` –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –ë–æ—Ç —Å–∞–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç `DJANGO_SETTINGS_MODULE="webapp.settings"`.

* **–ó–∞–ø—É—Å–∫ –∞–¥–º–∏–Ω–∫–∏: `ModuleNotFoundError: 'calendarapp'`**
  –ó–∞–ø—É—Å–∫–∞–π—Ç–µ: `python webapp/manage.py runserver` –∏–∑ **–∫–æ—Ä–Ω—è**. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `calendarapp` –≤ `INSTALLED_APPS`, –∏ –µ—Å—Ç—å `__init__.py`.

* **CSRF / `module 'secrets' has no attribute 'choice'`**
  –í –∫–æ—Ä–Ω–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∞—à–µ–≥–æ `secrets.py` (–∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –º–æ–¥—É–ª–µ–º). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bot_secrets.py`.

* **–ú–∏–≥—Ä–∞—Ü–∏–∏: `psycopg2.errors.InsufficientPrivilege`**
  –í—ã–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ë–î –∏/–∏–ª–∏ –Ω–∞ —Å—Ö–µ–º—É: `GRANT ALL ON DATABASE/SCHEMA/TABLES`.

* **–°–æ–±—ã—Ç–∏–µ ¬´–Ω–µ –Ω–∞–π–¥–µ–Ω–æ¬ª, —Ö–æ—Ç—è ID —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**
  –í—ã –ø—Ä–æ–≤–µ—Ä—è–µ—Ç–µ —á—É–∂–æ–µ —Å–æ–±—ã—Ç–∏–µ. –ë–æ—Ç –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç —á–∏—Ç–∞—Ç—å/–º–µ–Ω—è—Ç—å/—É–¥–∞–ª—è—Ç—å –Ω–µ —Å–≤–æ—ë.
  –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/display_events` –∏–ª–∏ `/calendar`, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å **—Å–≤–æ–∏** ID.

* **–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç**
  –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞—á–∏–Ω–∞–ª —á–∞—Ç —Å –±–æ—Ç–æ–º. –ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ Telegram –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –Ω–µ –Ω–∞–∂–º—ë—Ç ¬´Start¬ª. –°–æ–æ–±—â–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫—É –æ–± —ç—Ç–æ–º.

---

## –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ú–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å¬ª (–≤–Ω–µ –∞–¥–º–∏–Ω–∫–∏) ‚Äî —á–µ—Ä–µ–∑ DRF + –º–∏–Ω–∏-frontend.
* –£–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤—Å—Ç—Ä–µ—á–∞—Ö (APS/cron).
* –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç iCal/ICS.
* –¢–µ–≥–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π.
* –ü–æ–∫—Ä—ã—Ç–∏–µ unit-—Ç–µ—Å—Ç–∞–º–∏ –∫–ª—é—á–µ–≤—ã—Ö –º–æ–¥—É–ª–µ–π (`tgapp/*`, `calendarapp/utils.py`).

---