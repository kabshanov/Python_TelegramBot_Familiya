---

````md
# –ü—Ä–æ–µ–∫—Ç: Telegram-–±–æ—Ç —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è
# –ò–º—è –§–∞–º–∏–ª–∏—è ‚Äî –ú–∏—Ö–∞–∏–ª –ö–∞–±—à–∞–Ω–æ–≤
# –õ–æ–≥–∏–Ω –Ω–∞ GitHub ‚Äî kabshanov
# Telegram - @kabmik

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

* [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
* [–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#—Å—Ç–µ–∫-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
* [–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–∏-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
* [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
* [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
* [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
* [–û–ø–∏—Å–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π-–∏-–∫–ª—é—á–µ–≤—ã—Ö-—Ñ–∞–π–ª–æ–≤)
* [–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞](#–∫–æ–º–∞–Ω–¥—ã-–±–æ—Ç–∞)
* [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
* [–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è](#—Ç–∏–ø–∏—á–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è)

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* üì≤ **–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏—á–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –∏ –ø–æ—à–∞–≥–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏ (FSM).
* üóìÔ∏è **–í—Å—Ç—Ä–µ—á–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**: –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏, —Å—Ç–∞—Ç—É—Å–∞–º–∏ (–æ–∂–∏–¥–∞–µ—Ç—Å—è/–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ/–æ—Ç–º–µ–Ω–µ–Ω–æ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–æ).
* üóÑÔ∏è **PostgreSQL**: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –ë–î (–æ–±—â–∞—è –¥–ª—è –±–æ—Ç–∞ –∏ Django).
* üñ•Ô∏è **Django Admin**: –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏–π, –≤—Å—Ç—Ä–µ—á –∏ **—Å—É—Ç–æ—á–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–æ—Ç–∞**:
  * `user_count` ‚Äî –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ –¥–µ–Ω—å;
  * `event_count` ‚Äî —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è;
  * `edited_events` ‚Äî –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ;
  * `cancelled_events` ‚Äî —É–¥–∞–ª—ë–Ω–Ω—ã–µ.
* üîê **–ß–∏—Å—Ç—ã–µ –∏–º–ø–æ—Ä—Ç—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: —Ç–æ–∫–µ–Ω Telegram —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `bot_secrets.py` (–≤ `.gitignore`).
* üß© **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –ø–∞–∫–µ—Ç `tgapp/` (—è–¥—Ä–æ, FSM, —Ö–µ–Ω–¥–ª–µ—Ä—ã).
* üß∞ **–ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ**: Windows / macOS / Linux.

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

* **Python 3.11‚Äì3.13**
* **Django 5.x** (–ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, ORM, –º–∏–≥—Ä–∞—Ü–∏–∏)
* **python-telegram-bot 13.x** (Updater/Dispatcher API)
* **PostgreSQL 14‚Äì16**
* **psycopg2** (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏–∑ –±–æ—Ç–∞)
* **Django REST Framework** (–∑–∞–ª–æ–∂–µ–Ω–æ –¥–ª—è –±—É–¥—É—â–∏—Ö API)
* **Logging** (–±–∞–∑–æ–≤—ã–µ –ª–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π)

---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–û—Å–Ω–æ–≤–Ω—ã–µ:**
* Python ‚Äî <https://docs.python.org/3/>
* Django ‚Äî <https://docs.djangoproject.com/>
* python-telegram-bot (v13) ‚Äî <https://docs.python-telegram-bot.org/en/v13.15/>
* PostgreSQL ‚Äî <https://www.postgresql.org/docs/>
* psycopg2 ‚Äî <https://www.psycopg.org/docs/>

**–ë–∞–∑–æ–≤—ã–µ –≤–µ–±-–ø–æ–Ω—è—Ç–∏—è (MDN):**
* HTTP ‚Äî <https://developer.mozilla.org/en-US/docs/Web/HTTP>
* URL ‚Äî <https://developer.mozilla.org/en-US/docs/Web/API/URL>
* JSON ‚Äî <https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON>

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞**
* Python **3.11+**
* PostgreSQL **14+**
* –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (–¥–ª—è Telegram API)
* –°–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç **8000** (Django dev server)

**–ë—Ä–∞—É–∑–µ—Ä—ã (–¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)**
* Chrome/Edge/Firefox ‚Äî **–ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏**
* Safari ‚Äî **16+**

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
git clone git@github.com:kabshanov/Python_TelegramBot_Kabshanov.git
cd Python_TelegramBot_Kabshanov
python -m venv .venv
# Windows PowerShell:
. .venv/Scripts/Activate.ps1
# macOS/Linux:
# source .venv/bin/activate
````

### 2) –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements_part2.txt
# –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–∞:
# pip install django==5.* python-telegram-bot==13.13 psycopg2-binary==2.* djangorestframework==3.*
```

### 3) –°–µ–∫—Ä–µ—Ç—ã –∏ –ë–î

1. –°–æ–∑–¥–∞–π—Ç–µ `bot_secrets.py` –ø–æ –æ–±—Ä–∞–∑—Ü—É `secrets_example.py` –∏ –¥–æ–±–∞–≤—å—Ç–µ `API_TOKEN`:

   * [`secrets_example.py`](./secrets_example.py)
   * [`bot_secrets.py`](./bot_secrets.py) ‚Äî **–≤ .gitignore**.

2. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ PostgreSQL:

```sql
CREATE DATABASE calendar_db;
CREATE USER calendar_user WITH PASSWORD 'strong_password';
GRANT ALL PRIVILEGES ON DATABASE calendar_db TO calendar_user;
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –µ–¥–∏–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î:

   * Django: [`webapp/webapp/settings.py`](./webapp/webapp/settings.py) ‚Üí `DATABASES`
   * –ë–æ—Ç/psycopg2: [`db.py`](./db.py) ‚Üí `get_connection()`

### 4) –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

```bash
python webapp/manage.py migrate
python webapp/manage.py createsuperuser
```

### 5) –ó–∞–ø—É—Å–∫ (2 –ø—Ä–æ—Ü–µ—Å—Å–∞)

**A ‚Äî Django (–∞–¥–º–∏–Ω–∫–∞ + healthcheck):**

```bash
python webapp/manage.py runserver
# http://127.0.0.1:8000/ –∏ http://127.0.0.1:8000/admin/
```

**B ‚Äî Telegram-–±–æ—Ç:**

```bash
python bot.py
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
Python_TelegramBot_Kabshanov/
‚îú‚îÄ bot.py                      # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤, –∑–∞–ø—É—Å–∫ Updater/Dispatcher
‚îú‚îÄ db.py                       # psycopg2: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ CRUD –¥–ª—è users/events (–æ–±—â–∞—è –ë–î —Å Django)
‚îú‚îÄ secrets_example.py          # —à–∞–±–ª–æ–Ω —Å–µ–∫—Ä–µ—Ç–∞
‚îú‚îÄ bot_secrets.py              # —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω (–≤ .gitignore)
‚îú‚îÄ requirements_part2.txt      # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ tgapp/                      # –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ (–º–æ–¥—É–ª—å–Ω–æ)
‚îÇ  ‚îú‚îÄ __init__.py              # –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞
‚îÇ  ‚îú‚îÄ core.py                  # –æ–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã, –ª–æ–≥–≥–µ—Ä, —Ç—Ä–µ–∫–∏–Ω–≥, –º–µ–Ω—é –∫–æ–º–∞–Ω–¥
‚îÇ  ‚îú‚îÄ fsm.py                   # in-memory FSM (flow/step/data) + –ø–∞—Ä—Å–µ—Ä—ã –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
‚îÇ  ‚îú‚îÄ handlers_events.py       # –∫–æ–º–∞–Ω–¥—ã –∏ FSM –ø–æ —Å–æ–±—ã—Ç–∏—è–º (create/read/edit/delete)
‚îÇ  ‚îî‚îÄ handlers_appointments.py # FSM-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ, –∫–æ–ª–ª–±—ç–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
‚îú‚îÄ webapp/
‚îÇ  ‚îú‚îÄ manage.py                # CLI Django
‚îÇ  ‚îú‚îÄ webapp/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py           # –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ settings.py           # –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ë–î, INSTALLED_APPS, middleware, —Å—Ç–∞—Ç–∏–∫–∞)
‚îÇ  ‚îÇ  ‚îú‚îÄ urls.py               # –∫–æ—Ä–Ω–µ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (/admin, /)
‚îÇ  ‚îÇ  ‚îî‚îÄ wsgi.py               # WSGI-—Ç–æ—á–∫–∞
‚îÇ  ‚îî‚îÄ calendarapp/
‚îÇ     ‚îú‚îÄ __init__.py           # –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ     ‚îú‚îÄ apps.py               # AppConfig (verbose_name, name="calendarapp")
‚îÇ     ‚îú‚îÄ admin.py              # –∞–¥–º–∏–Ω–∫–∞: Event, BotStatistics, Appointment
‚îÇ     ‚îú‚îÄ models.py             # Event (managed=False, db_table="events"), BotStatistics, Appointment
‚îÇ     ‚îú‚îÄ utils.py              # –∑–∞–Ω—è—Ç–æ—Å—Ç—å/—Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å—Ç—Ä–µ—á (create_pending_invite_for_event –∏ –¥—Ä.)
‚îÇ     ‚îú‚îÄ urls.py               # –º–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ("/" ‚Äî healthcheck)
‚îÇ     ‚îú‚îÄ views.py              # healthcheck, —Ç–æ—á–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è API
‚îÇ     ‚îî‚îÄ migrations/
‚îÇ        ‚îî‚îÄ 0001_initial.py    # –º–∏–≥—Ä–∞—Ü–∏–∏ (BotStatistics, Appointment)
‚îî‚îÄ .gitignore                  # –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è bot_secrets.py, .venv, *.sqlite3 –∏ –¥—Ä.)
```

### –û–ø–∏—Å–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

* [`bot.py`](./bot.py) ‚Äî —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ Telegram-–±–æ—Ç–∞; —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –∏ —Ä–æ—É—Ç–µ—Ä–∞ FSM.
* [`db.py`](./db.py) ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –∏ CRUD –¥–ª—è `users`/`events` (–æ–±—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ `events`).
* [`tgapp/core.py`](./tgapp/core.py) ‚Äî –ª–æ–≥–≥–µ—Ä, –º–µ–Ω—é –∫–æ–º–∞–Ω–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –º–µ—Ç—Ä–∏–∫–∏.
* [`tgapp/fsm.py`](./tgapp/fsm.py) ‚Äî –ø—Ä–æ—Å—Ç–∞—è FSM (in-memory): `set_state/get_state/clear_state`, `parse_date/parse_time`.
* [`tgapp/handlers_events.py`](./tgapp/handlers_events.py) ‚Äî /create_event, /display_events, /read_event, /edit_event, /delete_event, /cancel –∏ —Ä–æ—É—Ç–µ—Ä `text_router` (–≤–∫–ª—é—á–∞—è –≤–µ—Ç–∫—É `INVITE`).
* [`tgapp/handlers_appointments.py`](./tgapp/handlers_appointments.py) ‚Äî FSM-–¥–∏–∞–ª–æ–≥ `/invite` –∏ callback-–æ–±—Ä–∞–±–æ—Ç–∫–∞ (‚úÖ/‚ùå).
* [`webapp/calendarapp/models.py`](./webapp/calendarapp/models.py) ‚Äî `Event` (—á–∏—Ç–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `events`), `BotStatistics`, `Appointment`.
* [`webapp/calendarapp/utils.py`](./webapp/calendarapp/utils.py) ‚Äî `get_user_busy_slots`, `is_user_free`, `create_pending_invite_for_event`.
* [`webapp/calendarapp/admin.py`](./webapp/calendarapp/admin.py) ‚Äî –∞–¥–º–∏–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã Event/BotStatistics/Appointment.
* [`webapp/webapp/settings.py`](./webapp/webapp/settings.py) ‚Äî –ë–î/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è/–ª–æ–∫–∞–ª—å/—Å—Ç–∞—Ç–∏–∫.
* [`requirements_part2.txt`](./requirements_part2.txt) ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞.

---

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

* `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î.
* `/create_event` ‚Äî –¥–∏–∞–ª–æ–≥: **–Ω–∞–∑–≤–∞–Ω–∏–µ ‚Üí –¥–∞—Ç–∞ (YYYY-MM-DD) ‚Üí –≤—Ä–µ–º—è (HH:MM) ‚Üí –æ–ø–∏—Å–∞–Ω–∏–µ**.
* `/display_events` ‚Äî —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* `/read_event <id>` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø–æ ID.
* `/edit_event <id> <–Ω–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ>` ‚Äî –∏–ª–∏ –¥–∏–∞–ª–æ–≥ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.
* `/delete_event <id>` ‚Äî –∏–ª–∏ –¥–∏–∞–ª–æ–≥ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.
* `/invite` ‚Äî **–¥–∏–∞–ª–æ–≥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –Ω–∞ –≤—Å—Ç—Ä–µ—á—É**:

  1. TG ID —É—á–∞—Å—Ç–Ω–∏–∫–∞ ‚Üí 2) ID –≤–∞—à–µ–≥–æ —Å–æ–±—ã—Ç–∏—è ‚Üí 3) –¥–µ—Ç–∞–ª–∏/¬´–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å¬ª.
     –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞–Ω—è—Ç–æ—Å—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞; –µ—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏:
     **¬´‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å¬ª** / **¬´‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å¬ª**. –°—Ç–∞—Ç—É—Å –≤—Å—Ç—Ä–µ—á–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.
* `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞ (FSM).

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —à–ª—ë—Ç –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É ‚Üí [`bot.py`](./bot.py) –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –≤ —Ö–µ–Ω–¥–ª–µ—Ä (–º–æ–¥—É–ª–∏ `tgapp/*`).
2. **–°–æ–±—ã—Ç–∏—è**:

   * –°–æ–∑–¥–∞–Ω–∏–µ/—á—Ç–µ–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `db.py` (psycopg2) –≤ –æ–±—â–µ–π –ë–î.
   * Django —á–∏—Ç–∞–µ—Ç —Ç–µ –∂–µ –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å `Event (managed=False, db_table="events")`.
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**:

   * –ú–µ—Ç—Ä–∏–∫–∏ –ø–∏—à—É—Ç—Å—è –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ Django ORM –≤ –º–æ–¥–µ–ª—å [`BotStatistics`](./webapp/calendarapp/models.py).
   * –ü—Ä–æ—Å–º–æ—Ç—Ä –≤ –∞–¥–º–∏–Ω–∫–µ (—Ä–∞–∑–¥–µ–ª ¬´–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞¬ª).
4. **–í—Å—Ç—Ä–µ—á–∏**:

   * –ë–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç —É—Ç–∏–ª–∏—Ç—É [`create_pending_invite_for_event`](./webapp/calendarapp/utils.py), –∫–æ—Ç–æ—Ä–∞—è —á–µ—Ä–µ–∑ ORM —Å–æ–∑–¥–∞—ë—Ç `Appointment` (—Å—Ç–∞—Ç—É—Å `pending`) —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫ **—Å–≤–æ–±–æ–¥–µ–Ω**.
   * –£—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∞–º–∏. –ù–∞–∂–∞—Ç–∏–µ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `confirmed` –∏–ª–∏ `cancelled`/`declined` –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞.
5. **FSM**:

   * –õ—ë–≥–∫–∞—è in-memory FSM (`tgapp/fsm.py`): `flow/step/data`. –î–∏–∞–ª–æ–≥–∏ `/create_event`, `/invite` –∏ —Ç.–ø. –≤–µ–¥—É—Ç—Å—è –ø–æ —à–∞–≥–∞–º; `–û—Ç–º–µ–Ω–∞` –æ—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

---

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

* **`ModuleNotFoundError: No module named 'calendarapp'` –ø—Ä–∏ runserver**
  –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏–∑ –∫–æ—Ä–Ω—è:
  `python webapp/manage.py runserver`
  –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `INSTALLED_APPS` —Å–æ–¥–µ—Ä–∂–∏—Ç `calendarapp`, –∏ –≤ –ø–∞–∫–µ—Ç–∞—Ö –µ—Å—Ç—å `__init__.py`.

* **`No module named 'webapp.settings'` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞**
  –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `python bot.py` –∏–∑ **–∫–æ—Ä–Ω—è**.
  –í –±–æ—Ç–µ –∑–∞–¥–∞–Ω `DJANGO_SETTINGS_MODULE="webapp.settings"`; –∫–∞—Ç–∞–ª–æ–≥ `webapp/` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ `sys.path`.

* **CSRF/–ª–æ–≥–∏–Ω –≤ –∞–¥–º–∏–Ω–∫—É: `AttributeError: module 'secrets' has no attribute 'choice'`**
  –≠—Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç **–≤–∞—à–µ–≥–æ** —Ñ–∞–π–ª–∞ `secrets.py` —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –º–æ–¥—É–ª–µ–º `secrets`.
  –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Å–≤–æ–π —Ñ–∞–π–ª –≤ `bot_secrets.py` (–∫–∞–∫ –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ) –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `secrets.py` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ.

* **`psycopg2.errors.InsufficientPrivilege` –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏—è—Ö**
  –í—ã–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ë–î: `GRANT ALL PRIVILEGES ON DATABASE ...`, –∞ —Ç–∞–∫–∂–µ –Ω–∞ —Å—Ö–µ–º—É/—Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

* **–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫—É**
  –£—á–∞—Å—Ç–Ω–∏–∫ –º–æ–≥ –Ω–µ –Ω–∞—á–∞—Ç—å —á–∞—Ç —Å –±–æ—Ç–æ–º. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±–æ—Ç —Å–æ–æ–±—â–∏—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—É –∏ –ø–æ–º–µ—Ç–∏—Ç –≤—Å—Ç—Ä–µ—á—É –∫–∞–∫ –æ—Ç–º–µ–Ω—ë–Ω–Ω—É—é (—á—Ç–æ–±—ã –Ω–µ ¬´–≤–∏—Å–µ–ª–∞¬ª –≤ `pending`).

* **–í –∞–¥–º–∏–Ω–∫–µ –ø—É—Å—Ç–æ –≤ ¬´–°–æ–±—ã—Ç–∏—è—Ö¬ª**
  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–æ–¥–µ–ª—å `Event` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É:
  `managed=False`, `db_table="events"`, –ø–æ–ª–µ `tg_user_id` ‚Üí `db_column="user_id"`.

---