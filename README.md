````md
# –ü—Ä–æ–µ–∫—Ç: Telegram-–±–æ—Ç —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è (–±–æ—Ç + Django)

**–ê–≤—Ç–æ—Ä:** –ú–∏—Ö–∞–∏–ª –ö–∞–±—à–∞–Ω–æ–≤  
**GitHub:** kabshanov  
**Telegram:** @kabmik

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π](#—Å—Ç–µ–∫-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π)
- [–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–∏-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–û–ø–∏—Å–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π-–∏-–∫–ª—é—á–µ–≤—ã—Ö-—Ñ–∞–π–ª–æ–≤)
- [–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞](#–∫–æ–º–∞–Ω–¥—ã-–±–æ—Ç–∞)
- [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
  - [–ï–¥–∏–Ω–∞—è –ë–î](#–µ–¥–∏–Ω–∞—è-–±–¥)
  - [–õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã (TgUser)](#–ª–∏—á–Ω—ã–µ-–∫–∞–±–∏–Ω–µ—Ç—ã-tguser)
  - [–î–æ—Å—Ç—É–ø –∏ –ø—Ä–∞–≤–∞](#–¥–æ—Å—Ç—É–ø-–∏-–ø—Ä–∞–≤–∞)
  - [–í—Å—Ç—Ä–µ—á–∏ (Appointment)](#–≤—Å—Ç—Ä–µ—á–∏-appointment)
  - [–ü—É–±–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è](#–ø—É–±–ª–∏—á–Ω—ã–µ-—Å–æ–±—ã—Ç–∏—è)
  - [–≠–∫—Å–ø–æ—Ä—Ç CSV/JSON](#—ç–∫—Å–ø–æ—Ä—Ç-csvjson)
  - [FSM (–¥–∏–∞–ª–æ–≥–∏)](#fsm-–¥–∏–∞–ª–æ–≥–∏)
- [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](#–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö)
- [–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å](#–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)
- [–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è](#—Ç–∏–ø–∏—á–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è)
- [–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è](#–ø–ª–∞–Ω-—Ä–∞–∑–≤–∏—Ç–∏—è)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì≤ **–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç**: —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π. –î–∏–∞–ª–æ–≥–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —á–µ—Ä–µ–∑ FSM.
- üë§ **–õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã**: –ø—Ä–∏–≤—è–∑–∫–∞ Telegram-–∞–∫–∫–∞—É–Ω—Ç–∞ –∫ Django-–ø—Ä–æ—Ñ–∏–ª—é (`/login`), –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–∏—á–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (`/calendar`).
- ü§ù **–í—Å—Ç—Ä–µ—á–∏ (Appointment)**: –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫, —Å—Ç–∞—Ç—É—Å—ã `pending / confirmed / declined / cancelled`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∞–º–∏.
- üåê **–ü—É–±–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**: –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç –ø–æ–º–µ—Ç–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –∫–∞–∫ –ø—É–±–ª–∏—á–Ω–æ–µ –∏ –¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π; –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ –±–æ—Ç.
- ‚¨áÔ∏è **–≠–∫—Å–ø–æ—Ä—Ç**: –≤—ã–≥—Ä—É–∑–∫–∞ —Å–≤–æ–∏—Ö —Å–æ–±—ã—Ç–∏–π –≤ **CSV** –∏ **JSON** –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Å—ã–ª–∫–µ (–ø–æ–¥–ø–∏—Å—å+TTL), –∫–Ω–æ–ø–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `/calendar`.
- üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: —Å—É—Ç–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (`BotStatistics`) –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –≤ –∫–∞—Ä—Ç–æ—á–∫–µ `TgUser`.
- üß© **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ (`tgapp/`), Django-—á–∞—Å—Ç—å —Å ORM –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ –æ—Ç–¥–µ–ª—å–Ω–æ (`webapp/`).

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Python** 3.11‚Äì3.13
- **Django** 5.x (–∞–¥–º–∏–Ω–∫–∞, ORM, –º–∏–≥—Ä–∞—Ü–∏–∏)
- **python-telegram-bot** 13.x (Updater/Dispatcher API)
- **PostgreSQL** 14‚Äì16
- **psycopg2 / psycopg2-binary**
- **Django REST Framework** (–∑–∞–ª–æ–∂–µ–Ω–æ –ø–æ–¥ API)
- **logging** (–µ–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –ª–æ–≥–æ–≤)

---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- Python ‚Äî https://docs.python.org/3/
- Django ‚Äî https://docs.djangoproject.com/
- python-telegram-bot v13 ‚Äî https://docs.python-telegram-bot.org/en/v13.15/
- PostgreSQL ‚Äî https://www.postgresql.org/docs/
- psycopg2 ‚Äî https://www.psycopg.org/docs/

MDN (–±–∞–∑–æ–≤—ã–µ –≤–µ–±-–ø–æ–Ω—è—Ç–∏—è):
- HTTP ‚Äî https://developer.mozilla.org/en-US/docs/Web/HTTP
- URL ‚Äî https://developer.mozilla.org/en-US/docs/Web/API/URL
- JSON ‚Äî https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞**
- Python **3.11+**
- PostgreSQL **14+**
- –°–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç **8000** (Django dev server)
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (Telegram Bot API)

**–ë—Ä–∞—É–∑–µ—Ä—ã –¥–ª—è –∞–¥–º–∏–Ω–∫–∏**
- Chrome/Edge/Firefox ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏
- Safari ‚Äî 16+

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
git clone git@github.com:kabshanov/Python_TelegramBot_Kabshanov.git
cd Python_TelegramBot_Kabshanov
python -m venv .venv
# Windows PowerShell
. .venv/Scripts/Activate.ps1
# macOS/Linux
# source .venv/bin/activate
````

### 2) –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements_part2.txt
# –Ω–∞ –≤—Å—è–∫–∏–π:
# pip install "django==5.*" "python-telegram-bot==13.13" "psycopg2-binary==2.*" "djangorestframework==3.*"
```

### 3) –°–µ–∫—Ä–µ—Ç—ã –∏ –ë–î

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `secrets_example.py` ‚Üí `bot_secrets.py` –∏ –∑–∞–¥–∞–π—Ç–µ `API_TOKEN`.
2. –ü–æ–¥–Ω–∏–º–∏—Ç–µ PostgreSQL –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–ë–î:

   ```sql
   CREATE DATABASE calendar_db;
   CREATE USER calendar_user WITH PASSWORD 'strong_password';
   GRANT ALL PRIVILEGES ON DATABASE calendar_db TO calendar_user;
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –µ–¥–∏–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

   * Django: [`webapp/webapp/settings.py`](webapp/webapp/settings.py) ‚Üí `DATABASES`
   * –ë–æ—Ç: [`db.py`](db.py) ‚Üí `get_connection()`

### 4) –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

```bash
python webapp/manage.py migrate
python webapp/manage.py createsuperuser
```

### 5) –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í `webapp/webapp/settings.py`:

```python
EXPORT_TOKEN_MAX_AGE = 900  # 15 –º–∏–Ω—É—Ç
```

### 6) –ó–∞–ø—É—Å–∫ (–¥–≤–µ –∫–æ–Ω—Å–æ–ª–∏)

**A ‚Äî Django:**

```bash
python webapp/manage.py runserver
# http://127.0.0.1:8000/  –∏  http://127.0.0.1:8000/admin/
```

**B ‚Äî –ë–æ—Ç:**

```bash
python bot.py
```

> –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç –∫–æ–ª–æ–Ω–∫—É `events.is_public` (–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤).

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
Python_TelegramBot_Kabshanov/
‚îú‚îÄ bot.py                      # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞: –º–µ–Ω—é, —Ö–µ–Ω–¥–ª–µ—Ä—ã, FSM-—Ä–æ—É—Ç–µ—Ä, –∑–∞–ø—É—Å–∫
‚îú‚îÄ db.py                       # psycopg2-CRUD –¥–ª—è users/events, ensure_is_public_column()
‚îú‚îÄ secrets_example.py          # –ø—Ä–∏–º–µ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤
‚îú‚îÄ bot_secrets.py              # —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (–≤ .gitignore)
‚îú‚îÄ requirements_part2.txt      # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ tgapp/
‚îÇ  ‚îú‚îÄ __init__.py              # –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ (–¥–ª—è IDE –∏ —á–∏—Ç–∞—Ç–µ–ª—è)
‚îÇ  ‚îú‚îÄ core.py                  # –ª–æ–≥–≥–µ—Ä, –º–µ–Ω—é –∫–æ–º–∞–Ω–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Å—á—ë—Ç—á–∏–∫–∏
‚îÇ  ‚îú‚îÄ fsm.py                   # –ø—Ä–æ—Å—Ç–∞—è in-memory FSM (flow/step/data), –ø–∞—Ä—Å–µ—Ä—ã –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
‚îÇ  ‚îú‚îÄ handlers_events.py       # CRUD —Å–æ–±—ã—Ç–∏–π, /login, /calendar, —à—ë—Ä–∏–Ω–≥, —ç–∫—Å–ø–æ—Ä—Ç (–∫–Ω–æ–ø–∫–∏), —Ä–æ—É—Ç–µ—Ä
‚îÇ  ‚îî‚îÄ handlers_appointments.py # –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –Ω–∞ –≤—Å—Ç—Ä–µ—á–∏, –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏, —Å—Ç–∞—Ç—É—Å—ã
‚îú‚îÄ webapp/
‚îÇ  ‚îú‚îÄ manage.py                # CLI Django
‚îÇ  ‚îú‚îÄ webapp/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ settings.py           # INSTALLED_APPS, –ë–î, –ª–æ–∫–∞–ª—å/—Ç–∞–π–º–∑–æ–Ω–∞, EXPORT_TOKEN_MAX_AGE
‚îÇ  ‚îÇ  ‚îú‚îÄ urls.py               # –∫–æ—Ä–Ω–µ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (/admin, /)
‚îÇ  ‚îÇ  ‚îî‚îÄ wsgi.py
‚îÇ  ‚îî‚îÄ calendarapp/
‚îÇ     ‚îú‚îÄ __init__.py
‚îÇ     ‚îú‚îÄ apps.py               # AppConfig, verbose_name
‚îÇ     ‚îú‚îÄ admin.py              # —É–¥–æ–±–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞: –∏–Ω–ª–∞–π–Ω—ã, —Ñ–∏–ª—å—Ç—Ä—ã, —Å—á—ë—Ç—á–∏–∫–∏
‚îÇ     ‚îú‚îÄ models.py             # Event(managed=False), TgUser, Appointment, BotStatistics
‚îÇ     ‚îú‚îÄ utils.py              # –∑–∞–Ω—è—Ç–æ—Å—Ç—å, —Å–ª–æ—Ç—ã, —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–≤–∞–π—Ç–∞, —Ç–æ–∫–µ–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
‚îÇ     ‚îú‚îÄ urls.py               # healthcheck, export/<fmt> (csv|json)
‚îÇ     ‚îú‚îÄ views.py              # —ç–∫—Å–ø–æ—Ä—Ç CSV/JSON –ø–æ —Ç–æ–∫–µ–Ω—É, healthcheck
‚îÇ     ‚îî‚îÄ migrations/
‚îî‚îÄ .gitignore
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

* `bot.py` ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Telegram-–±–æ—Ç: —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã, FSM-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞; –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Django-–æ–∫—Ä—É–∂–µ–Ω–∏–µ.
* `db.py` ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ `users`/`events` (psycopg2), –±–µ–∑ ORM. –°–æ–¥–µ—Ä–∂–∏—Ç `ensure_is_public_column()` –¥–ª—è Task 5.
* `tgapp/core.py` ‚Äî –æ–±—â–µ–µ: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–µ–Ω—é –∫–æ–º–∞–Ω–¥, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–ø—Ä–∏–≤—è–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤ –≤ `TgUser`/`BotStatistics`.
* `tgapp/fsm.py` ‚Äî in-memory FSM: `set_state/get_state/clear_state`, –ø–∞—Ä—Å–µ—Ä—ã `parse_date/parse_time`, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –æ—Ç–º–µ–Ω—ã.
* `tgapp/handlers_events.py` ‚Äî –∫–æ–º–∞–Ω–¥—ã `/start /help /register /login /calendar /create_event /display_events /read_event /edit_event /delete_event /share_event /my_public /public_of /export /cancel`, inline –∏ –¥–∏–∞–ª–æ–≥–æ–≤—ã–µ –≤–µ—Ç–∫–∏, –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞.
* `tgapp/handlers_appointments.py` ‚Äî –¥–∏–∞–ª–æ–≥ `/invite`, –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Å—Ç–∞—Ç—É—Å—ã.
* `webapp/calendarapp/models.py` ‚Äî `Event (managed=False, db_table="events")`, `TgUser`, `Appointment`, `BotStatistics`.
* `webapp/calendarapp/utils.py` ‚Äî —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–≤–∞–π—Ç–∞, –ø–æ–¥–ø–∏—Å—å/–ø—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞, —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.
* `webapp/calendarapp/urls.py` ‚Äî `"" ‚Üí healthcheck`, `"export/<str:fmt>/" ‚Üí export_events`.
* `webapp/calendarapp/views.py` ‚Äî `export_events` (CSV/JSON): –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å/TTL —Ç–æ–∫–µ–Ω–∞, –æ—Ç–¥–∞—ë—Ç —Ñ–∞–π–ª; `healthcheck`.

---

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

**–°–ø—Ä–∞–≤–∫–∞/–ø—Ä–æ—Ñ–∏–ª—å**

* `/start`, `/help` ‚Äî –∫—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞.
* `/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ `users` –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å `TgUser`.
* `/login` ‚Äî –ø—Ä–∏–≤—è–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π Telegram-–∞–∫–∫–∞—É–Ω—Ç –∫ `TgUser`.
* `/calendar` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –ª–∏—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ **–∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞** (CSV/JSON).

**–°–æ–±—ã—Ç–∏—è**

* `/create_event` ‚Äî –¥–∏–∞–ª–æ–≥: *–Ω–∞–∑–≤–∞–Ω–∏–µ ‚Üí –¥–∞—Ç–∞ (YYYY-MM-DD) ‚Üí –≤—Ä–µ–º—è (HH:MM) ‚Üí –æ–ø–∏—Å–∞–Ω–∏–µ*.
* `/display_events` ‚Äî —Å–ø–∏—Å–æ–∫ –º–æ–∏—Ö —Å–æ–±—ã—Ç–∏–π (—á–µ—Ä–µ–∑ `db.py`).
* `/read_event <id>` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –º–æ—ë —Å–æ–±—ã—Ç–∏–µ.
* `/edit_event [<id> <–Ω–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ>]` ‚Äî –ª–∏–±–æ –¥–∏–∞–ª–æ–≥, –ª–∏–±–æ —Å—Ä–∞–∑—É.
* `/delete_event [<id>]` ‚Äî –¥–∏–∞–ª–æ–≥ –∏–ª–∏ —Å—Ä–∞–∑—É.

**–ü—É–±–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**

* `/share_event` ‚Äî —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ—ë —Å–æ–±—ã—Ç–∏–µ –ø—É–±–ª–∏—á–Ω—ã–º (–¥–∏–∞–ª–æ–≥, —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤–ª–∞–¥–µ–ª—å—Ü–∞).
* `/my_public` ‚Äî –º–æ–∏ –ø—É–±–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.
* `/public_of` ‚Äî –ø—É–±–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–í—Å—Ç—Ä–µ—á–∏**

* `/invite` ‚Äî –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–∞ —Å–≤–æ—ë —Å–æ–±—ã—Ç–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, –∏–Ω–ª–∞–π–Ω-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ).

**–°–ª—É–∂–µ–±–Ω–æ–µ**

* `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –¥–∏–∞–ª–æ–≥.

> –õ—é–±—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ **—Å–≤–æ–∏–º–∏** —Å–æ–±—ã—Ç–∏—è–º–∏: —á—É–∂–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å –Ω–µ–ª—å–∑—è.

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ï–¥–∏–Ω–∞—è –ë–î

* –ë–æ—Ç –ø–∏—à–µ—Ç/—á–∏—Ç–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É `events` –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `db.py` (psycopg2).
* Django —á–∏—Ç–∞–µ—Ç —Ç–µ –∂–µ —Å—Ç—Ä–æ–∫–∏ –º–æ–¥–µ–ª—å—é `Event` (`managed=False`, `db_table="events"`).
* –¢–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–≤–æ–π–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã.

### –õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã (TgUser)

* `/login` —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å `TgUser` (tg_id, username, –∏–º—è/—Ñ–∞–º–∏–ª–∏—è, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å).
* –í –∞–¥–º–∏–Ω–∫–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–∏–¥–µ–Ω **–∏–Ω–ª–∞–π–Ω-—Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π** –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π.

### –î–æ—Å—Ç—É–ø –∏ –ø—Ä–∞–≤–∞

* –í–ª–∞–¥–µ–ª–µ—Ü —Å–æ–±—ã—Ç–∏—è ‚Äî `tg_user_id` (—Å—Ç–æ–ª–±–µ—Ü `user_id` –≤ `events`).
* –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ –∫–æ–º–∞–Ω–¥—ã —á—Ç–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è.

### –í—Å—Ç—Ä–µ—á–∏ (Appointment)

* `/invite` –∑–∞–ø—É—Å–∫–∞–µ—Ç FSM: TG ID —É—á–∞—Å—Ç–Ω–∏–∫–∞ ‚Üí ID —Å–æ–±—ã—Ç–∏—è (–≤–∞—à–µ–≥–æ) ‚Üí –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.
* –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–∞ –¥–∞—Ç—É/–≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è; –µ—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è `pending` –≤—Å—Ç—Ä–µ—á–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ.
* –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä —É–≤–µ–¥–æ–º–ª—è–µ—Ç—Å—è.

### –ü—É–±–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

* –ö–æ–º–∞–Ω–¥–∞ `/share_event` –ø–æ–º–µ—á–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ —Ñ–ª–∞–≥–æ–º `is_public=True`.
* `/my_public` ‚Äî —Å–ø–∏—Å–æ–∫ —Ç–æ–ª—å–∫–æ –≤–∞—à–∏—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.
* `/public_of` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—É–±–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø–æ TG ID –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* –í–Ω—É—Ç—Ä–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ ¬´is_public=True¬ª –≤ —Ç–µ–∫—Å—Ç–µ).

### –≠–∫—Å–ø–æ—Ä—Ç CSV/JSON

* –í `/calendar` –±–æ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç **–∫–Ω–æ–ø–∫–∏ —Å URL** –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç Django:

  * `/export/csv/?token=...`
  * `/export/json/?token=...`
* –¢–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç `tg_user_id`, –ø–æ–¥–ø–∏—Å–∞–Ω `django.core.signing` –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (`EXPORT_TOKEN_MAX_AGE`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 900 —Å).
* –î–æ—Å—Ç—É–ø –ø–æ —Ç–æ–∫–µ–Ω—É –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–∞—á–∞—Ç—å **—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏** —Å–æ–±—ã—Ç–∏—è.
* **CSV**: –∑–∞–≥–æ–ª–æ–≤–∫–∏ `id,name,date,time,details,tg_user_id`.
* **JSON**: —á–∏—Ç–∞–µ–º—ã–π (UTF-8, `ensure_ascii=False`, `indent=2`).

### FSM (–¥–∏–∞–ª–æ–≥–∏)

* –ü—Ä–æ—Å—Ç–∞—è in-memory FSM —Å —à–∞–≥–∞–º–∏ `flow/step/data` –∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –æ—Ç–º–µ–Ω–æ–π.
* –î–∏–∞–ª–æ–≥–∏: `CREATE`, `EDIT`, `DELETE`, `INVITE`, (–≤–µ—Ç–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Å–æ–±—ã—Ç–∏–π).
* –õ–æ–≥–∏ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —à–∞–≥–æ–≤.

---

## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

**Event** (`managed=False`, `db_table="events"`)

* `id`, `name`, `date`, `time`, `details`, `tg_user_id` (db_column=`user_id`), `is_public` (bool).
* –í–ª–∞–¥–µ–Ω–∏–µ ‚Äî –ø–æ `tg_user_id`. –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü —É–ø—Ä–∞–≤–ª—è–µ—Ç.

**TgUser**

* `tg_id`, `username`, `first_name`, `last_name`, `is_active`
* –°—á—ë—Ç—á–∏–∫–∏: `created_total`, `edited_total`, `cancelled_total`
* –ò–Ω–ª–∞–π–Ω-—Å–æ–±—ã—Ç–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–∑–æ—Ä–∞).

**Appointment**

* `event` (FK –±–µ–∑ DB-constraint –∫ `Event`), `organizer_tg_id`, `participant_tg_id`
* `date`, `time`, `details`, `status` (`pending|confirmed|declined|cancelled`)
* –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —É—Ç–∏–ª–∏—Ç—ã.

**BotStatistics**

* `date (unique)`, `user_count`, `event_count`, `edited_events`, `cancelled_events`
* –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö –≤ –±–æ—Ç–µ.

---

## –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

* –†–∞–∑–¥–µ–ª—ã: **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ TG (TgUser)**, **–°–æ–±—ã—Ç–∏—è (Event)**, **–í—Å—Ç—Ä–µ—á–∏ (Appointment)**, **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞ (BotStatistics)**.
* –£–¥–æ–±–Ω—ã–µ —Å–ø–∏—Å–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫.
* –í –∫–∞—Ä—Ç–æ—á–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –∏–Ω–ª–∞–π–Ω-—Å–æ–±—ã—Ç–∏—è –∏ —Å—á—ë—Ç—á–∏–∫–∏.
* –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∞–¥–º–∏–Ω–∫–∏.

---

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

* **`ModuleNotFoundError: 'webapp.settings'` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞**
  –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `python bot.py` –∏–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–æ–Ω —Å–∞–º –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç `DJANGO_SETTINGS_MODULE`).

* **`ModuleNotFoundError: 'calendarapp'` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞**
  `python webapp/manage.py runserver` ‚Äî —Ç–æ–∂–µ –∏–∑ –∫–æ—Ä–Ω—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `INSTALLED_APPS` –∏ –Ω–∞–ª–∏—á–∏–µ `__init__.py` –≤ –ø–∞–∫–µ—Ç–∞—Ö.

* **CSRF/`module 'secrets' has no attribute 'choice'`**
  –í –∫–æ—Ä–Ω–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ñ–∞–π–ª–∞ `secrets.py` (–∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bot_secrets.py`.

* **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –Ω–∞ —Å—Ö–µ–º—É/—Ç–∞–±–ª–∏—Ü—ã**
  –í—ã–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ë–î –Ω–∞ –±–∞–∑—É/—Å—Ö–µ–º—É/—Ç–∞–±–ª–∏—Ü—ã. –î–ª—è –æ–±—â–µ–π —Ç–∞–±–ª–∏—Ü—ã `events` —É Django `managed=False`, –º–∏–≥—Ä–∞—Ü–∏–π –Ω–µ –±—É–¥–µ—Ç.

* **–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è**
  –£—á–∞—Å—Ç–Ω–∏–∫ –µ—â—ë –Ω–µ –ø–∏—Å–∞–ª –±–æ—Ç—É ‚Äî Telegram –Ω–µ –¥–∞—Å—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ü–æ–ø—Ä–æ—Å–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–∞–∂–∞—Ç—å **Start** –≤ –±–æ—Ç–µ.

---

## –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ¬´–ú–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å¬ª (–≤–Ω–µ –∞–¥–º–∏–Ω–∫–∏) –Ω–∞ DRF + –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ—Ä–æ–Ω—Ç.
* –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ N –º–∏–Ω—É—Ç –¥–æ —Å–æ–±—ã—Ç–∏—è (APS/cron).
* iCal/ICS —ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç.
* –ú–µ—Ç–∫–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π.
* Unit-—Ç–µ—Å—Ç—ã –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤ `LICENSE`.

```